

'''
Hey Pim, try fiddling with this. from what I can make of it it accesses the directory using os.walk
which should return the file names

os.walk returns the root directory, list of directories, and the files found in those directors in a tuple.

We only want the 3rd item, the files, so we can easily only get that.

'''

import os
import mysql.connector

def main():
    pass

if __name__ == '__main__':
    main()

cnx = mysql.connector.connect()
cursor = cnx.cursor()

#change to directory to the one holding the malware files
for root, dir, files in os.walk("L:\Preservation", topdown=True):
    for name in files:

        #we don't really need the join function.
        #it might work if we just use something like this :
        #fname = name

        fname = os.path.join(root, name)
        print(fname)
        sql = "INSERT INTO malware VALUES('" + (fname) + "')"
        cursor.execute(sql)
        cnx.commit()
    #    print(os.path.join(root, name))
    #for name in dirs:
    #    print(os.path.join(root, name))

cnx.close()

'''
The mysql db is set up so the id number auto increments when something is put in. So if this works we'll have the 
name and id number of all the malware. you can manually enter the rest, or we could do more complex things to figure out 
the rest of the info. 
'''
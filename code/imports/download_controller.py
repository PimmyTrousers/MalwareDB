import paramiko

config = {}
exec(compile(open("imports/keys.py", "rb").read(), "imports/keys.py", 'exec'), config)


class Download_Controller:
    def __init__(self):
        self.client = paramiko.SSHClient()
        self.client.set_missing_host_key_policy(paramiko.AutoAddPolicy())

    def download_file(self, location):
        base = "/root/malware"
        try:
            self.client.connect(config['host'], username=config['user'], password=config['ssh_pass'])
        except paramiko.SSHException:
            print("Connection Error")
        sftp = self.client.open_sftp()
        sftp.chdir(base)
        sftp.get(location, location)
        self.client.close()

    def upload_file(self, location):
        result = False
        base = "/root/malware/"
        try:
            self.client.connect(config['host'], username=config['user'], password=config['ssh_pass'])
        except paramiko.SSHException:
            print("Connection Error")
        sftp = self.client.open_sftp()
        sftp.chdir(base)
        try:
            sftp.put(location, base + location)
            print("file {} was found!".format(location))
            result = True
        except:
            print("file not in local directory")
        return result

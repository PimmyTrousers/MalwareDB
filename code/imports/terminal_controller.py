# import db_handler
from imports.pretty import *

class Terminal_Controller:
    def __init__(self):

        self.modules = None
        self.currentmodule = None
        # self.db = db_handler.DBHandler()

        self.commands = [('help', 'Displays this help menu'),
                         ('use', 'selects a malware sample'),
                         ('info', 'displays information about a malware sample'),
                         ('download', 'downloads the selected malware sample'),
                         ('exit', 'leaves the malwareDB'),
                         ('search', 'allows the user to search for a sample')]

        self.bare_commands = {('help'),
                              ('use'),
                              ('info'),
                              ('download'),
                              ('exit'),
                              ('search')}

        self.searchmeth = [("arch", "which architecture etc; x86, x64, arm7 so on..."),
                           ("plat",
                            "platform: win32, win64, mac, android so on..."),
                           ("lang", "c, cpp, vbs, bin so on..."),
                           ]
        self.searchmeth = [("arch", "which architecture etc; x86, x64, arm7 so on..."),
                           ("plat",
                            "platform: win32, win64, mac, android so on..."),
                           ("lang", "c, cpp, vbs, bin so on..."),
                           ("vip", "1 or 0"),
                           ("classification", "which malware classification is it...")]

        self.modules = self.GetPayloads()

    def MainMenu(self):
        # This will give you the nice prompt you like so much
        while (True):  # Dont hate, affiliate
            try:
                if self.currentmodule is not None:
                    # just_print = self.db.query("SELECT NAME FROM Malwares WHERE ID=?", self.currentmodule)[0][0]
                    cmd = input(bold(green('mdb ')) + bold(blue(just_print)) + green('#> ')).strip()
                else:
                    cmd = input(bold(green('mdb ')) + green('#> ')).strip()
            except KeyboardInterrupt:
                print(bold(blue("\n\n[*]")) + " Hope you enjoyed your visit at" + bold(red(" theZoo")) + "!")
                exit()

            self.actOnCommand(cmd)

    def GetPayloads(self):
        return None # self.db.get_full_details()


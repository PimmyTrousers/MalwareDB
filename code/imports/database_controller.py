import pymysql.cursors

config = {}
exec(compile(open("keys.py", "rb").read(), "keys.py", 'exec'), config)

class Database_Controller:
    #connects to MYSQL db
    def __init__(self):
        self.mysqldb = pymysql.connect(host='45.55.22.31',
                                       user = 'root',
                                       passwd = config["password"],
                                       db = 'MalwareDB'
                                       )


    #executes a mysql command
    def execute(self, command):
        with self.mysqldb.cursor() as cursor:
            cursor.execute(command, ('root', 'Cipriani1!'))
    #gets table information
    def get_table(self):
        with self.mysqldb.cursor() as cursor:
            cursor.execute("select * from malware")
            result = cursor.fetchall()
        return result

    #search_malware table for keyword
    def search_db(self , keyword):
        with self.mysqldb.cursor() as cursor:
            cursor.execute("SELECT * FROM malware "
                           "WHERE (id LIKE \"{}\" "
                           "OR filename LIKE \"{}\" "
                           "OR architecture LIKE \"{}\" "
                           "OR lang LIKE \"{}\" "
                           "OR platform LIKE \"{}\" "
                           "OR vip LIKE \"{}\")".format(keyword, keyword, keyword, keyword, keyword, keyword))
            result = cursor.fetchall()
        return result
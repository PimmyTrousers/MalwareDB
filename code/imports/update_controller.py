import pymysql
config = {}
exec(compile(open("imports/keys.py", "rb").read(), "imports/keys.py", 'exec'), config)

class Update_Controller:

    def __init__(self):
        self.mysqldb = pymysql.connect(host=config['host'],
                                       user=config['user'],
                                       passwd=config["password"],
                                       db='MalwareDB')

    def manual_add(self):
        #creates mysql cursor
        with self.mysqldb.cursor() as cursor:
            #input information
            id = self.check_for_id() + 1
            filename = input("insert filename: ")
            architecture = input("input architecture: ")
            lang = input("input lang: ")
            platform = input("input platform: ")
            vip = int(input("input vip: "))
            location = input("input location: ")

            #converts info to mysql command
            sql = "insert into malware VALUES(%d, '%s', '%s', '%s', '%s', %d, '%s')" % \
                  (id, filename, architecture, lang, platform, vip, location)
            #executes mysql command
            cursor.execute(sql)
            self.mysqldb.commit()

            self.mysqldb.close()

    def check_for_id(self):
        max = 0
        with self.mysqldb.cursor() as cursor:
            cursor.execute("SELECT id FROM malware")
            result = cursor.fetchall()
            for element in result:
                if element[0] > max:
                    max = element[0]
            return max
